<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag and Drop List</title>
    <style>
        .container {
            display: flex;
        }
        .number-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
            margin-right: 10px;
        }
        .number-list li, .item-list li {
            padding: 8px;
            border: 1px solid #ccc;
            background: #f9f9f9;
            display: flex;
            align-items: center;
            height: 40px; /* Altura fixa para garantir alinhamento */
        }
        .item-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .item-list li {
            background: #fff;
            cursor: move;
            margin-bottom: 4px;
        }
        .dragging {
            opacity: 0.5;
        }
        .placeholder {
            background: #e2e2e2;
            border: 2px dashed #ccc;
        }
    </style>
</head>
<body>

<div class="container">
    <ol class="number-list">
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li>6</li>
        <li>7</li>
        <li>8</li>
        <li>9</li>
        <li>10</li>
        <li>11</li>
        <li>12</li>
        <li>13</li>
        <li>14</li>
        <li>15</li>
        <li>16</li>
        <li>17</li>
        <li>18</li>
    </ol>
    <ul class="item-list" id="sortable-list">
        <li draggable="true">Item 1</li>
        <li draggable="true">Item 2</li>
        <li draggable="true">Item 3</li>
        <li draggable="true">Item 4</li>
        <li draggable="true">Item 5</li>
        <li draggable="true">Item 6</li>
        <li draggable="true">Item 7</li>
        <li draggable="true">Item 8</li>
        <li draggable="true">Item 9</li>
        <li draggable="true">Item 10</li>
        <li draggable="true">Item 11</li>
        <li draggable="true">Item 12</li>
        <li draggable="true">Item 13</li>
        <li draggable="true">Item 14</li>
        <li draggable="true">Item 15</li>
        <li draggable="true">Item 16</li>
        <li draggable="true">Item 17</li>
        <li draggable="true">Item 18</li>
    </ul>
</div>

<script>
    const sortableList = document.getElementById('sortable-list');
    let draggingEle;
    let placeholder;
    let isDraggingStarted = false;

    const swap = (nodeA, nodeB) => {
        const parentA = nodeA.parentNode;
        const siblingA = nodeA.nextSibling === nodeB ? nodeA : nodeA.nextSibling;

        nodeB.parentNode.insertBefore(nodeA, nodeB);
        parentA.insertBefore(nodeB, siblingA);
    };

    const isAbove = (nodeA, nodeB) => {
        const rectA = nodeA.getBoundingClientRect();
        const rectB = nodeB.getBoundingClientRect();

        return (rectA.top + rectA.height / 2) < (rectB.top + rectB.height / 2);
    };

    const mouseDownHandler = function (e) {
        draggingEle = e.target;
        isDraggingStarted = false;

        placeholder = document.createElement('li');
        placeholder.classList.add('placeholder');
        draggingEle.parentNode.insertBefore(placeholder, draggingEle.nextSibling);

        draggingEle.classList.add('dragging');

        document.addEventListener('mousemove', mouseMoveHandler);
        document.addEventListener('mouseup', mouseUpHandler);
    };

    const mouseMoveHandler = function (e) {
        const draggingRect = draggingEle.getBoundingClientRect();

        if (!isDraggingStarted) {
            isDraggingStarted = true;

            placeholder.style.height = `${draggingRect.height}px`;
        }

        draggingEle.style.position = 'absolute';
        draggingEle.style.top = `${e.pageY - draggingRect.height / 2}px`;
        draggingEle.style.left = `${e.pageX - draggingRect.width / 2}px`;

        const prevEle = draggingEle.previousElementSibling;
        const nextEle = placeholder.nextElementSibling;

        if (prevEle && prevEle !== placeholder && isAbove(draggingEle, prevEle)) {
            swap(placeholder, draggingEle);
            swap(placeholder, prevEle);
            return;
        }

        if (nextEle && nextEle !== placeholder && isAbove(nextEle, draggingEle)) {
            swap(nextEle, placeholder);
            swap(nextEle, draggingEle);
        }
    };

    const mouseUpHandler = function () {
        placeholder && placeholder.parentNode.removeChild(placeholder);

        draggingEle.classList.remove('dragging');
        draggingEle.style.removeProperty('top');
        draggingEle.style.removeProperty('left');
        draggingEle.style.removeProperty('position');

        isDraggingStarted = false;
        draggingEle = null;

        document.removeEventListener('mousemove', mouseMoveHandler);
        document.removeEventListener('mouseup', mouseUpHandler);
    };

    sortableList.querySelectorAll('li').forEach(function (item) {
        item.addEventListener('mousedown', mouseDownHandler);
    });
</script>

</body>
</html>
